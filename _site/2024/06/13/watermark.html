<!DOCTYPE html>
<html>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="/assets/js/mathjax-config.js" defer></script>
  <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script> 

     
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Watermarks for LLM</title>
        <meta name="viewport" content="width=device-width">

        
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/assets/css/post.css">
        
    </head>

    <body>
        <header class="site-header">

            <div class="wrap">
                
              <div style="float:left; margin-top:10px; margin-right:10px;">
                
              </div>

              <div class="site-nav"><nav>
                  <div class="menu-item">
                    <a href="/blog.html" >Blog
                    </a>
                  </div>

              </nav></div>
          
              
            </div>
          
          </header>

    <div class="page-content">
      <div class="wrap">
        <div class="post">

            <header class="post-header">
              <h1>Watermarks for LLM</h1>
              <p class="meta">Jun 13, 2024 â€¢ Kaizhao Liu</p>
            </header>
          
            <article class="post-content">
            <p>Statistical watermark leverage the psuedorandomness during decoding.</p>

<p>Naively, the psuedorandomness enables users to reproduce the entire sequence given the key, just like reproducing any numerical experiment. Thus comparison between the reproduced sequence and the sequence at hand can be made, enabling the determination of whether the sequence at hand is produced by a LLM. However, this intuitive method assumes that each next-token-distribution of LLM is known, which is unrealistic given the unaccessiblity of closed-source LLM.</p>

<p>The good news is that this naive method can be further developed leveraging statistical ideas. The problem at hand is naturally a hypothesis testing problem. To get rid of the troublesome next-token-distribution, we can construct a test statistic that is <strong>pivotal</strong> with respect to these distributions, i.e. the distribution of the test statistic is the same regardless of these distributions.</p>

<h1 id="reflection-on-popular-existing-decoding-methods">Reflection on Popular Existing Decoding Methods</h1>

<ul>
  <li><strong>greedy methods</strong>: simply outputs</li>
  <li><strong>sampling-based methods</strong>: recursively samples from the next-word distribution</li>
  <li><strong>planning-based methods</strong>: aims at maximizing the sequence likelihood</li>
</ul>

<p>In <a href="https://arxiv.org/abs/2402.05864">Permute-and-Flip: An optimally robust and watermarkable decoder for LLMs</a>, the authors propose a new <em>sampling-based</em> decoding method</p>

<p>Similar to the idea of Gumbel watermark, we can inject psuedo-randomness during the sampling</p>

<h1 id="sampling-methods-and-construction-of-pivotal-statistics">Sampling Methods and Construction of Pivotal Statistics</h1>

<ul>
  <li>
    <p><strong>Gumbel-Max</strong></p>
  </li>
  <li>
    <p><strong>Inverse Transform</strong></p>
  </li>
  <li>
    <p><strong>Alias Method</strong></p>
  </li>
</ul>

<p>Given a</p>

<h1 id="debiasing-green-red-list">Debiasing Green-Red List</h1>

<p>The Green-Red list specify a green list and let LLMs only output tokens from the green list. We can denote this output distribution by $Q_w$.
Then LLM-generated texts can be detected by counting the numbers of tokens from the green list.
However, this approach modifies the generated distribution of LLMs, which might result in degraded generation results.</p>

<p>In, <a href="https://arxiv.org/abs/2411.11203">Debiasing Watermarks for Large Language Models via Maximal Coupling</a>, the authors proposed a way to debias this watermark by considering the maximal coupling between $Q_w$ and $P_w$.
The output, which is the marginal, is always $P_w$, but we also know the underlying coupling $\xi$. When the output is from the green list, $\xi$ is typically smaller.
Thus we can consider the pivotal staistics $\sum \xi$ (sum over tokens from green list) for detection.</p>

<p>Another way is to use higher criticism.</p>

<h1 id="statistical-theory-of-watermarks-detection">Statistical Theory of Watermarks Detection</h1>

<p>Further, we can compare the efficacy of different pivotal statistics by modifying the established framework of hypothesis testing in mathematical statistics, as in <a href="https://arxiv.org/abs/2404.01245">A Statistical Framework of Watermarks for Large Language Models: Pivot, Detection Efficiency and Optimal Rules</a>.</p>

<h1 id="detection-of-watermarks-in-hybrid-ai-human-texts">Detection of Watermarks in Hybrid AI-Human Texts</h1>

<p><a href="https://arxiv.org/abs/2411.13868">Robust Detection of Watermarks for Large Language Models Under Human Edits</a></p>

<p>Formulate as a mixture detection problem, different from previous formulations, so optimal test might be different.
goodness of fit test</p>

<p>Empirical work
<a href="https://arxiv.org/abs/2510.03944">On the Empirical Power of Goodness-of-Fit Tests in Watermark Detection</a></p>

<h1 id="estimation-of-watermark-proportions-in-hybrid-ai-human-texts">Estimation of Watermark Proportions in Hybrid AI-Human Texts</h1>

<p>Some works investigate the problem of identifying watermarked segments within mixed-source texts, but information theoretically it is more difficult than detecting their aggregate presence.</p>

<p><a href="https://arxiv.org/abs/2506.22343">Optimal Estimation of Watermark Proportions in Hybrid AI-Human Texts</a></p>

<p>watermarks for diffusion models?</p>

            </article>
          


      </div>
    </div>

    <footer class="site-footer">

        <div class="wrap">

      
          <div class="footer-col-2 column">
            
          </div>
      
      
        </div>
      
      </footer>

    </body>
</html>
