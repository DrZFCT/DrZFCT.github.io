<!DOCTYPE html>
<html>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="/assets/js/mathjax-config.js" defer></script>
  <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script> 

     
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Diffusion Models</title>
        <meta name="viewport" content="width=device-width">

        
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/assets/css/post.css">
        
    </head>

    <body>
        <header class="site-header">

            <div class="wrap">
                
              <div style="float:left; margin-top:10px; margin-right:10px;">
                
              </div>

              <div class="site-nav"><nav>
                  <div class="menu-item">
                    <a href="/blog.html" >Blog
                    </a>
                  </div>

              </nav></div>
          
              
            </div>
          
          </header>

    <div class="page-content">
      <div class="wrap">
        <div class="post">

            <header class="post-header">
              <h1>Diffusion Models</h1>
              <p class="meta">Mar 7, 2024 • Kaizhao Liu</p>
            </header>
          
            <article class="post-content">
            <p>For an arbitary high-dimensional distribution 
$x\sim \mathcal{P}$</p>

<h1 id="reversing-lindblad-equation">Reversing Lindblad Equation</h1>

<p>The quantum version of Fokker-Planck equation, also named Lindblad equation, is the following:</p>

\[\dot{\rho}=-i[H,\rho]+\sum_i \cD[L_i](\rho),\]

<p>where</p>

\[\cD[L](\rho):=L\rho L^\dagger -\frac{1}{2}\{L^\dagger L,\rho\}.\]

<p>Here $[A,B]=AB-BA$ is the commutator and ${A,B}=AB+BA$ is the anticommutator. Note that $H$ is Hermitian.</p>

<p>To reverse a Lindblad operator $L$, exactly similar to what we have done in standard diffusion model, what we need to do is solve this equation for $L_b$ and $H_b$, where $H_b$ is Hermitian:</p>

\[-\cD[L](\rho)=\cD[L_b](\rho)-i[H_b,\rho].\]

<p>One way to solve for $L_b$ and $H_b$ goes like this. First notice that $\rho$ is Hermitian. Thus it has an eigenvalue decomposition under a suitable set of basis, which I denote by $\rho=\sum_i\lambda_i\ket{i}\bra{i}$ following physicists convention.</p>

<p>Expanding $[H_b,\rho]$ under this basis gives 
\(\bra{i}[H_b,\rho] \ket{j}= (\lambda_j-\lambda_i)\bra{i} H_b \ket{j}.\)
Plugging this expansion into the equation we want to solve, we find that the condition that $H_b$ is Hermitian imposes that \(\cD[L_b](\rho)+\cD[L](\rho)\) should be Hermitian. Moreover, the diagonal elements of 
\(\cD[L_b](\rho)+\cD[L](\rho)\)
should be zero for $H_b$ to be solvable.</p>

<p>Now recall that 
\(\cD[L](\rho):=L\rho L^\dagger -\frac{1}{2} L^\dagger L\rho -\frac{1}{2} \rho L^\dagger L.\)
This is already Hermitian, but the diagonal elements are not all zero.</p>

<p>Now the magic part begins. Consider \(L_b=\rho^{\frac{1}{2}}L^\dagger \rho^{-\frac{1}{2}}.\)
Then</p>

\[\cD[L_b](\rho):= -\frac{1}{2}\rho^{-\frac{1}{2}} L\rho L^\dagger\rho^{\frac{1}{2}}-\frac{1}{2}\rho^{\frac{1}{2}} L\rho L^\dagger\rho^{-\frac{1}{2}}+\rho^{\frac{1}{2}} L^\dagger L\rho^{\frac{1}{2}}.\]

<p>Summing and noticing that for Hermitian $A$, operator of the form</p>

\[A -\frac{1}{2}\rho^{-\frac{1}{2}}A\rho^{\frac{1}{2}}-\frac{1}{2}\rho^{\frac{1}{2}}A\rho^{-\frac{1}{2}}\]

<p>is Hermitian with zero diagonal elements.</p>

<p>In summary, the reverse Lindblad’s equation can be expressed by</p>

\[\begin{align}
    &amp;\dot{\overleftarrow{\rho}}= -i[H_b,\overleftarrow{\rho}]+\sum_i \cD[L_{b,i}](\overleftarrow{\rho})\\
    &amp;H_b = -H + \sum_i H_c(\rho,L_i), \\
    &amp; L_{b,i} = \rho^{\frac{1}{2}}L_i^\dagger\rho^{-\frac{1}{2}},
\end{align}\]

<p>where</p>

\[\begin{align}
    &amp;H_c(\rho,L)=-\frac{i}{2}\sum_{i,j}\frac{\sqrt{\lambda_i}-\sqrt{\lambda_j}}{\sqrt{\lambda_i}+\sqrt{\lambda_j}}\bra{i} M(\rho,L) \ket{j}\ket{i}\bra{j},\\ 
    &amp;M(\rho,L)=L^\dagger L +\rho^{-\frac{1}{2}}L\rho L^\dagger \rho^{\frac{1}{2}}
\end{align}\]

<h1 id="qubit-channel">Qubit Channel</h1>

<p>For an arbitary density matrix $\rho$, we have the formula</p>

\[\frac{I}{2}=\frac{1}{4}(\rho + X\rho X^\dagger+ Y\rho Y^\dagger +Z\rho Z^\dagger)\]

<p>where</p>

\[X = \begin{pmatrix}
0 &amp; 1\\
1 &amp; 0
\end{pmatrix}\quad
Y=\begin{pmatrix}
0  &amp; -i\\
i  &amp; 0
\end{pmatrix}\quad
Z = \begin{pmatrix}
1  &amp; 0\\
0  &amp; -1
\end{pmatrix}\]

<p>The lindblad equation for quantum qubit channel can be written as</p>

\[\dot{\rho}=-\gamma (\rho - \frac{I}{2}),\]

<p>or in the Lindblad’s form as</p>

\[\dot{\rho}=\frac{\gamma}{4}(\cD[X](\rho)+\cD[Y](\rho)+\cD[Z](\rho))\]

<p>At $t=0$, $\rho(0)$ has an eigenvalue decomposition $\rho(0)=U\Lambda(0) U^\dagger$, where $U$ is unitary and $\Lambda(0)$ is diagonal. As the qubit channel admits the unitary freedom, we can focus on the case where $U=I$, and the result can be easily generalized to arbitary $U$. Say</p>

\[\Lambda(0)=\begin{pmatrix}
\lambda_1(0)  &amp; \\
  &amp; \lambda_2(0)
\end{pmatrix}\]

<p>where $\lambda_i(0)\geq 0$ for $i\in [2]$ and $\lambda_1(0)+\lambda_2(0)=1$.</p>

<p>At time $t$, solving the Lindblad equation yields</p>

\[\Lambda(t)=\begin{pmatrix}
\lambda_1(t)  &amp; \\
  &amp; \lambda_2(t)
\end{pmatrix}=\begin{pmatrix}
\frac{1}{2}+e^{-\gamma t}(\lambda_1(0)-\frac{1}{2})  &amp; \\
  &amp; \frac{1}{2}+e^{-\gamma t}(\lambda_2(0)-\frac{1}{2})
\end{pmatrix} .\]

<p>The reversed Hamiltonian can be expressed by</p>

\[H_b = 0\]

<p>and the reversed Lindblad operators can be expressed by</p>

\[X_b = \sqrt{\frac{\gamma}{4}}\begin{pmatrix}
 0 &amp; \sqrt{\frac{\lambda_1(t)}{\lambda_2(t)}}\\
 \sqrt{\frac{\lambda_2(t)}{\lambda_1(t)}} &amp; 0
\end{pmatrix},\quad 
Y_b = \sqrt{\frac{\gamma}{4}}\begin{pmatrix}
 0 &amp; i\sqrt{\frac{\lambda_1(t)}{\lambda_2(t)}}\\
 -i\sqrt{\frac{\lambda_2(t)}{\lambda_1(t)}} &amp; 0
\end{pmatrix},\quad 
Z_b = \sqrt{\frac{\gamma}{4}}Z.\]

<p>For general $U$, the reversed Lindblad operators can be obtained by 
the transformation $X \mapsto U^\dagger X U$. Note that the operator $Z$ can actually be dropped.</p>

<h1 id="d-dimensional-channel">$d$-dimensional channel</h1>

<p>For $d$-dimensional density matrix, notice that $I = \tr(\rho)I$ can be expressed as an operator sum.</p>

<h1 id="questions">Questions</h1>

<p>For quantum state preparation, we already know the $\Lambda(0)$ we want and we want to prepare this from the state $I/2$, we do not need to learn anything, just apply the reversed Lindblad operators.</p>

<p>Maybe I have some misunderstanding here for we have discussed to “learn” something via quantum process tomography just like diffusion models.</p>

<p>How to physically implement a given (time-dependent) Lindblad operator  ? To prepare a pure state, the reversed Lindblad operators seems to blow up.</p>

<p>For $d$-dimensional channel, it seems thaat $d^2$ Lindblad operators are necessary, which suffers from the curse of dimensionality.</p>


            </article>
          


      </div>
    </div>

    <footer class="site-footer">

        <div class="wrap">

      
          <div class="footer-col-2 column">
            
          </div>
      
      
        </div>
      
      </footer>

    </body>
</html>
